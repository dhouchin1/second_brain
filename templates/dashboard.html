{% extends "base.html" %}
{% block title %}Dashboard — Second Brain Premium{% endblock %}
{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <!-- Quick Capture -->
  <section class="lg:col-span-2 rounded-2xl bg-white/95 dark:bg-slate-950/90 shadow-xl ring-1 ring-black/5 p-6">
    <h2 class="text-lg font-semibold text-slate-900 dark:text-white">Quick Capture</h2>
    <form class="mt-4 space-y-4"
          hx-post="/notes"
          hx-target="#recent-notes"
          hx-swap="afterbegin"
          hx-on:htmx:afterRequest="if(event.detail.successful){ this.reset(); window.TagEditor && window.TagEditor.reset(); }">
      <label class="sr-only" for="body">What's on your mind?</label>
      <textarea id="body" name="body" required rows="5"
                class="w-full rounded-xl border-slate-300 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100"
                placeholder="What's on your mind?"></textarea>

      <!-- Smart Tag Editor -->
      <input type="hidden" id="tagsInput" name="tags" />
      <div>
        <div class="text-xs text-slate-500 mb-1">Tags</div>
        <div id="tag-editor"
             class="min-h-[44px] rounded-xl px-2 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 flex flex-wrap gap-2">
          <!-- tokens injected here -->
          <input id="tag-entry" type="text" placeholder="type and press Enter"
                 class="bg-transparent outline-none flex-1 min-w-[140px] text-slate-800 dark:text-slate-200 placeholder:text-slate-400" />
        </div>
        <div id="tag-suggestions" class="mt-2 flex flex-wrap gap-2"></div>
      </div>

      <button type="submit"
              class="px-4 py-2 rounded-xl bg-brand-600 hover:bg-brand-700 text-white shadow">
        Save Note
      </button>
    </form>
  </section>

  <!-- Stats -->
  <aside class="rounded-2xl bg-white/95 dark:bg-slate-950/90 shadow-xl ring-1 ring-black/5 p-6">
    <h2 class="text-lg font-semibold text-slate-900 dark:text-white">Overview</h2>
    <dl class="mt-4 grid grid-cols-2 gap-4">
      <div class="rounded-xl bg-slate-50 dark:bg-slate-900 p-4">
        <dt class="text-sm text-slate-500">Total Notes</dt>
        <dd class="text-2xl font-semibold text-slate-900 dark:text-white">{{ stats.notes }}</dd>
      </div>
      <div class="rounded-xl bg-slate-50 dark:bg-slate-900 p-4">
        <dt class="text-sm text-slate-500">Today</dt>
        <dd class="text-2xl font-semibold text-slate-900 dark:text-white">✨</dd>
      </div>
    </dl>
  </aside>
</div>

<!-- Recent Notes -->
<section class="mt-6 rounded-2xl bg-white/95 dark:bg-slate-950/90 shadow-xl ring-1 ring-black/5 p-6">
  <h2 class="text-lg font-semibold text-slate-900 dark:text-white">Recent Notes</h2>
  <ul id="recent-notes" class="mt-4 divide-y divide-slate-200/80 dark:divide-white/10">
    {% for n in recent %}
      {% include 'partials/note_item.html' %}
    {% else %}
      <li class="py-8 text-slate-500">No notes yet. Start capturing your thoughts!</li>
    {% endfor %}
  </ul>
</section>
{% endblock %}
